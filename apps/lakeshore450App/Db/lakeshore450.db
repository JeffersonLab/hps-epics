#
# Lakeshore Model 450 Gaussmeter
# 
# Notes:
#   [Macros]
#   P	  - standard record prefix
#   R	  - standard record prefix
#   PORT  - asyn port name
# 
# Author: Wesley Moore (wmoore@jlab.org)
# Date:   Oct. 2014
#

record(asyn, "$(P)$(R)ASYN") {
	field(PORT, "$(PORT)")
}

#######################################
# Interface Commands
#######################################
record(mbbi, "$(P)$(R)MODE") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getMode $(PORT)")
	field(ZRST, "Local")
	field(ONST, "Remote")
	field(TWST, "Remote w/ Local Lockout")
	field(SCAN, "1 second")
}

#######################################
# Device Specific Commands
#######################################
record(bi, "$(P)$(R)ACDC") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getACDC $(PORT)")
	field(ZNAM, "DC")
	field(ONAM, "AC")
	field(SCAN, "1 second")
}

record(bo, "$(P)$(R)ACDC:SET") {
	field(DTYP, "stream")
	field(OUT,  "@lakeshore450.proto setACDC $(PORT)")
	field(ZNAM, "DC")
	field(ONAM, "AC")
}

record(bi, "$(P)$(R)AUTO") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getAuto $(PORT)")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
	field(SCAN, "1 second")
}

record(bo, "$(P)$(R)AUTO:SET") {
	field(DTYP, "stream")
	field(OUT,  "@lakeshore450.proto setAuto $(PORT)")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
}

record(ai, "$(P)$(R)FIELD:RAW") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getUnit $(PORT)")
	field(PREC, "2")
	field(SCAN, "1 second")
	field(FLNK, "$(P)$(R)FIELD")
}

record(calc, "$(P)$(R)FIELD") {
	field(CALC, "A*B")
	field(INPA, "$(P)$(R)FIELD:RAW")
	field(INPB, "$(P)$(R)FIELD:MULT.VAL")
}

record(mbbi, "$(P)$(R)FIELD:MULT") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getMult $(PORT)")
	field(ZRST, "u")
	field(ZRVL, "1e-6")
	field(ONST, "m")
	field(ONVL, "1e-3")
	field(TWST, "k")
	field(TWVL, "1e3")
	field(THST, "_")
	field(THVL, "1")
	field(SCAN, "1 second")
}

record(bi, "$(P)$(R)UNIT") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getUnit $(PORT)")
	field(ZNAM, "G")
	field(ONAM, "T")
	field(SCAN, "1 second")
}

record(bi, "$(P)$(R)UNIT:SET") {
	field(DTYP, "stream")
	field(OUT,  "@lakeshore450.proto setUnit $(PORT)")
	field(ZNAM, "G")
	field(ONAM, "T")
}

record(bi, "$(P)$(R)FILTER") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getFilt $(PORT)")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
	field(SCAN, "1 second")
}

record(bi, "$(P)$(R)FILTER:SET") {
	field(DTYP, "stream")
	field(OUT,  "@lakeshore450.proto setFilt $(PORT)")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
}

record(mbbi, "$(P)$(R)RANGE") {
	field(DTYP, "stream")
	field(INP,  "@lakeshore450.proto getRange $(PORT)")
	field(SCAN, "1 second")
}

record(mbbo, "$(P)$(R)RANGE:SET") {
	field(DTYP, "stream")
	field(OUT,  "@lakeshore450.proto setRange $(PORT)")
}

